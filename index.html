// Замініть слухач у коді віджета (на сайті)
db.ref('support/' + userId).on('value', snap => {
    const area = document.getElementById('sc-msg-area');
    area.innerHTML = '';
    
    if (snap.numChildren() === 0) {
        db.ref('config/faq').once('value', faqSnap => {
            const faqs = faqSnap.val() || [];
            if (faqs.length > 0) {
                const faqCont = document.createElement('div');
                faqCont.className = 'faq-container';
                faqCont.innerHTML = '<p style="font-size: 11px; color: #999; margin-bottom: 8px; text-transform: uppercase;">Швидкі питання:</p>';
                faqs.forEach(item => {
                    const btn = document.createElement('button');
                    btn.className = 'faq-btn';
                    btn.innerText = item.q;
                    btn.onclick = () => sendFAQ(item.q, item.a);
                    faqCont.appendChild(btn);
                });
                area.appendChild(faqCont);
            }
        });
    } else {
        snap.forEach(child => {
            const m = child.val();
            const time = new Date(m.ts).toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});
            const div = document.createElement('div');
            div.className = 'scm ' + m.type;
            div.innerHTML = `${m.text} <small>${time}</small>`;
            area.appendChild(div);
        });
        area.scrollTop = area.scrollHeight;
    }
});
